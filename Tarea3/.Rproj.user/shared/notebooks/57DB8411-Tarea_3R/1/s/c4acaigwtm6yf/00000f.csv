"0","df <- casen # reiniciamos el anÃ¡lisis"
"0","df <- df %>%"
"0","  mutate("
"0","    totalmin = ifelse(is.na(o25a_hr),"
"0","                      0,"
"0","                      o25a_hr * 60) + ifelse(is.na(o25a_min),"
"0","                                             0,"
"0","                                             o25a_min)"
"0","  )"
"0","minutes_to_hhmm <- function(minutes) {"
"0","  hours <- floor(minutes / 60)"
"0","  mins <- minutes %% 60"
"0","  sprintf(""%02d:%02d"", hours, mins)"
"0","}"
"0","df <- df %>%"
"0","  mutate(o1 = as.factor(o1)) %>%"
"0","  filter(o1 == 1) %>%"
"0","  filter(o25a_min != 99) %>%"
"0","  filter(o25a_hr != 99) %>%"
"0","  mutate(total_time = sapply(totalmin, minutes_to_hhmm)) %>%"
"0","  mutate(ocup = case_when("
"0","    edad>=15 & o1 == 2 & o2 == 2 & o3 == 2 & o6 == 1 ~ 2,"
"0","    edad>=15 & (o1 == 1 | o2 == 1 | o3) == 1 ~ 1,"
"0","    edad>=15 & o3 == 2 & o6 == 2 ~ 3,"
"0","    TRUE ~ NA_real_"
"0","  )) %>%"
"0","  mutate(ocup = factor(ocup,"
"0","                       levels = c(1, 2, 3))) %>%"
"0","  mutate(ocup = recode(ocup,"
"0","                       `1` = 'Ocupado',"
"0","                       `2` = 'No ocupado',"
"0","                       `3` = 'Inactivo')) %>%"
"0","  mutate(ocup = factor(ocup,"
"0","                       levels = c('Ocupado',"
"0","                                  'No ocupado',"
"0","                                  'Inactivo'))) %>%"
"0","  filter(ocup == 'Ocupado')"
"0",""
